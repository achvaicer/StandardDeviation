using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using MathNet.Numerics;
using NUnit.Framework;
using SharpTestsEx;

namespace StandardDeviation
{
    public class Test
    {
        double[] values = new[] { 0.00338292362109814000D, -0.00171805632141716000D, -0.00288138617754290000D, -0.00279841821973942000D, 0.01621291969019810000D, -0.00819285616320123000D, 0.00391608243195414000D, 0.00401663544776369000D, 0.00020472898819137000D, 0.00806526690183135000D, 0.00838662802910089000D, -0.00103736564939682000D, -0.00831864319863721000D, 0.00463632480792898000D, 0.00763378346813827000D, 0.00688358771251352000D, 0.00185230298662239000D, -0.01241649579816850000D, -0.00662961541705967000D, 0.01011518572828950000D, 0.00316589569762294000D, 0.00729370564306760000D, -0.00032239307255032100D, 0.00716920051419125000D, -0.00062179663261663600D, -0.01688253424073360000D, -0.00218620869811500000D, 0.00412148486843223000D, -0.00134687435021419000D, -0.00624901552764785000D, 0.00574549291648769000D, 0.00242097450562473000D, -0.01128462854981450000D, 0.00574270116750062000D, 0.00309775396671025000D, -0.00451897842398888000D, 0.00324917990806127000D, 0.01392027690014360000D, -0.00545017621040002000D, 0.01708668766065380000D, 0.01316594614283010000D, -0.00351812070626937000D, -0.02119163713187970000D, 0.00371290923825560000D, 0.00120063398673181000D, -0.00840075527007803000D, -0.00294592870232766000D, -0.00660191900890998000D, -0.00362418926435471000D, -0.00525957158135620000D, 0.00657732132171799000D, 0.00454617173885287000D, 0.00421810574706612000D, -0.00710654296874192000D, -0.00696081039179625000D, 0.00740831239551902000D, -0.00383698371998431000D, -0.00341728579345460000D, 0.00113129315989055000D, 0.01170894997217570000D, 0.00333898556198469000D, 0.00193464068936454000D, -0.00732153941726761000D, 0.00358550061191929000D, 0.01169194481326080000D, -0.01303552827051480000D, -0.05843350149222200000D, -0.00704471953143066000D, -0.00448730886323494000D, -0.00675022920699099000D, -0.00614951951177232000D, -0.00780763711226688000D, -0.01191526344930570000D, -0.00864331595340070000D, -0.01551198010031000000D, 0.01032239527372610000D, 0.00003304439738487270D, 0.01458639731720350000D, -0.00839841492163554000D, -0.00716813343723477000D, -0.01267059059083510000D, -0.01270475421689900000D, 0.01632212352870360000D, 0.00664833689799760000D, -0.00090108995942893100D, 0.02165307665044980000D, -0.01053794686223600000D, -0.01147848633572480000D, 0.00168703570368596000D, -0.02078646251278730000D, 0.01947986999980350000D, -0.01218981670278080000D, 0.01268174900263920000D, -0.00140203217683030000D, 0.00637961086376509000D, -0.00959794400157166000D, -0.01175114129593170000D, -0.01190389076069070000D, 0.00827417023451590000D, -0.00354089028132116000D, 0.00517500781560863000D, -0.00601001681289114000D, -0.01455151212976310000D, -0.00019113923845283300D, 0.00237713336427058000D, -0.01155022531265010000D, 0.00019859992974775400D, -0.00273750158300017000D, 0.00469778272264690000D, -0.00321384036051855000D, 0.00621061514177257000D, -0.01114575062273080000D, -0.01583286383986620000D, 0.01589304377224920000D, -0.01265895778753560000D, -0.01650782462828240000D, 0.00120370535725386000D, -0.01166780801460700000D, 0.00474667508899097000D, 0.00678700003033575000D, -0.00660082138890437000D, 0.00175751965856918000D, -0.01182353585083440000D, -0.01458754834930000000D, -0.02123649019201600000D, -0.00073841288749928600D, 0.00205945235234942000D, -0.01280090234291100000D, -0.01311628812715980000D, 0.01452736923231880000D, -0.01126786068359150000D, 0.00442638248201572000D, 0.00788554524772302000D, -0.01431512112523360000D, 0.03075126015892750000D, 0.00104663171117953000D, -0.00509368271661235000D, 0.00666885052572583000D, -0.02047660053100850000D, 0.04480998343123340000D, -0.01176702860620370000D, 0.01232417663533640000D, -0.01379337272579480000D, -0.00779427778539763000D, 0.01838703541505070000D, -0.00209181847552854000D, 0.02751859335853930000D, -0.01540604932864550000D, 0.02854876052450630000D, 0.00224419504358589000D, 0.03363422640085210000D, -0.01940173510150590000D, 0.01454252850285400000D, -0.01820237365908480000D, -0.01867743751325070000D, 0.00926814758817615000D, 0.00682796100021193000D, 0.00790557688067537000D, -0.00904112939691552000D, 0.02230091551137820000D, 0.00601886360028953000D, -0.02553503988323620000D, 0.01251110630762010000D, -0.01187635379203610000D, -0.01863239710684370000D, 0.01578623336739850000D, 0.01662894832445840000D, -0.00623841158392953000D, 0.01499720334882190000D, -0.00208391980040989000D, -0.02818821324212010000D, 0.00194367174282703000D, -0.01980462481310600000D, 0.00258359195813229000D, 0.01141945197031280000D, 0.02401099153425420000D, 0.00709838005832223000D, 0.00559446454971050000D, -0.01542313046836930000D, 0.00940990549790190000D, 0.00460379187738462000D, -0.00786376727515154000D, -0.01364043509896020000D, 0.00514184940003272000D, 0.00891548068252369000D, -0.00352178905587822000D, 0.00761045893472319000D, -0.00079392739462354900D, -0.00986435748113410000D, 0.01667633979076650000D, -0.00403790820787684000D, -0.00481147379146078000D, -0.01868271029390850000D, -0.01546989905882350000D, 0.03449213000682810000D, 0.00789053368125703000D, -0.00059149133366743300D, -0.00651322326506477000D, 0.00238847348530526000D, -0.03345501551949730000D, -0.01077484468327840000D, 0.00429438661919209000D, -0.01673414707947710000D, -0.00066298821463600500D, -0.01051716295442840000D, 0.00090319285840587300D, -0.00585723889221807000D, -0.00379492794857125000D, 0.01042257665440990000D, -0.00981532999014957000D, -0.00503593081402698000D, -0.00588421943038175000D, -0.00760691933124738000D, -0.00150750427141166000D, 0.02378200049610540000D, -0.01409196572456330000D, 0.00865800012557309000D, -0.00701140811827287000D, 0.00407878824190256000D, -0.01214928878465540000D, 0.00477228625924513000D, 0.00471468686596622000D, 0.00712653853673799000D, 0.01556666463228930000D, -0.01204627905976190000D, 0.00956861935974727000D, -0.00761104612107364000D, -0.00085319359037406700D, 0.01288893652428140000D, -0.00659316847095755000D, 0.01071180937519120000D, 0.00047837109051654600D, -0.02035783093617950000D, 0.00758342072944520000D, -0.01627627010663450000D, -0.00851979914786817000D, -0.00030275171858206600D, 0.00573857421715279000D, -0.00800260340934128000D, 0.00696083787969913000D, -0.00403620156104793000D, -0.01679117720975590000D, -0.00104084899559712000D, -0.01366698472494520000D, 0.01152494647458830000D, -0.00475870559071841000D, -0.00007206565383252610D, 0.01928454065043890000D, -0.00245929979023467000D, -0.00551337000320261000D, -0.00183439961283808000D };

        [Test]
        public void ShouldBeEqualToExcel()
        {
            Math.Round(MathNet.Numerics.Statistics.Statistics.StandardDeviation(values), 14).Should().Be(0.01220866990915);
            Math.Round(MathNet.Numerics.Statistics.Statistics.PopulationStandardDeviation(values), 14).Should().Be(0.01218432557803);
        }
    }
}
