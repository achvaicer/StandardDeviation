using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using MathNet.Numerics;
using NUnit.Framework;
using SharpTestsEx;

namespace StandardDeviation
{
    public class Test
    {
        double[] values = new [] { 0.0118657142D, 0.0115119315D, 0.0111835252D, 0.0108644756D, 0.0112572708D, 0.0110972948D, 0.0108019024D, 0.0105189463D, 0.0101986201D, 0.0100833553D, 0.0099896818D, 0.0096886885D, 0.0096119943D, 0.0093881169D, 0.0092922017D, 0.0091655517D, 0.0088979076D, 0.0091472704D, 0.0090160585D, 0.0090857565D, 0.0088430361D, 0.0087578090D, 0.0084913781D, 0.0084179058D, 0.0081628835D, 0.0089294963D, 0.0086740141D, 0.0084701480D, 0.0082187376D, 0.0081140496D, 0.0079917566D, 0.0077709556D, 0.0080252761D, 0.0079069254D, 0.0077035100D, 0.0075504101D, 0.0073635318D, 0.0079116845D, 0.0077859702D, 0.0086314162D, 0.0089683774D, 0.0087377638D, 0.0099354282D, 0.0096755936D, 0.0093854449D, 0.0093292949D, 0.0090738254D, 0.0089447957D, 0.0087176197D, 0.0085496704D, 0.0084443308D, 0.0082624681D, 0.0080771171D, 0.0080221948D, 0.0079625025D, 0.0079303433D, 0.0077459841D, 0.0075565154D, 0.0073315523D, 0.0076650199D, 0.0074763833D, 0.0072640966D, 0.0072675560D, 0.0071006814D, 0.0074563121D, 0.0079029295D, 0.0162350658D, 0.0158347847D, 0.0153916905D, 0.0150141208D, 0.0146344590D, 0.0143169445D, 0.0141843158D, 0.0139142208D, 0.0140152239D, 0.0138215057D, 0.0134004494D, 0.0134745501D, 0.0132250404D, 0.0129418129D, 0.0129257000D, 0.0129125499D, 0.0131420931D, 0.0128453788D, 0.0124560126D, 0.0131899378D, 0.0130460297D, 0.0129573260D, 0.0125693883D, 0.0132073757D, 0.0136651603D, 0.0135811601D, 0.0135288817D, 0.0131212325D, 0.0128171254D, 0.0126471030D, 0.0125951427D, 0.0125547409D, 0.0123398518D, 0.0119953283D, 0.0116987806D, 0.0114375259D, 0.0116478654D, 0.0112931216D, 0.0109645595D, 0.0110005788D, 0.0106655678D, 0.0103623699D, 0.0101123755D, 0.0098358658D, 0.0096568061D, 0.0097525553D, 0.0102199007D, 0.0106458874D, 0.0107772806D, 0.0112040745D, 0.0108667540D, 0.0109164750D, 0.0106475874D, 0.0104562255D, 0.0102658143D, 0.0099623822D, 0.0100837432D, 0.0104090709D, 0.0113537282D, 0.0110093337D, 0.0106858591D, 0.0108244222D, 0.0109754385D, 0.0112203076D, 0.0112231664D, 0.0109351483D, 0.0107765361D, 0.0110209377D, 0.0130733241D, 0.0126776505D, 0.0123546019D, 0.0120891038D, 0.0127489261D, 0.0165305501D, 0.0162840817D, 0.0160740212D, 0.0159463832D, 0.0155780280D, 0.0157606929D, 0.0152891471D, 0.0162840080D, 0.0162326696D, 0.0172218318D, 0.0167062320D, 0.0181721756D, 0.0182482856D, 0.0180474109D, 0.0180567462D, 0.0180945881D, 0.0176896349D, 0.0172320938D, 0.0168189846D, 0.0164563079D, 0.0168642022D, 0.0164167853D, 0.0171015346D, 0.0168613879D, 0.0166045441D, 0.0167331469D, 0.0166778483D, 0.0166749183D, 0.0162389899D, 0.0161671727D, 0.0156829649D, 0.0166994786D, 0.0161977437D, 0.0164364923D, 0.0159483315D, 0.0157134514D, 0.0163306296D, 0.0159283181D, 0.0155037582D, 0.0154989324D, 0.0152025218D, 0.0147824681D, 0.0144609962D, 0.0144130800D, 0.0140306443D, 0.0137773941D, 0.0133855061D, 0.0131109348D, 0.0127130105D, 0.0125603236D, 0.0128445336D, 0.0124924539D, 0.0121690894D, 0.0126548075D, 0.0128411280D, 0.0150460399D, 0.0147151605D, 0.0142676131D, 0.0139246624D, 0.0135131320D, 0.0154532436D, 0.0152131656D, 0.0147871732D, 0.0149111623D, 0.0144578203D, 0.0142521401D, 0.0138197335D, 0.0134753243D, 0.0130978392D, 0.0129529146D, 0.0127863896D, 0.0124580853D, 0.0121642549D, 0.0119399692D, 0.0115821176D, 0.0126503649D, 0.0127414614D, 0.0125340260D, 0.0122729495D, 0.0119409364D, 0.0119535400D, 0.0116481919D, 0.0113522354D, 0.0111439717D, 0.0114575775D, 0.0114937499D, 0.0113874237D, 0.0111968163D, 0.0108577277D, 0.0109901918D, 0.0107770798D, 0.0107731747D, 0.0104456377D, 0.0112885403D, 0.0111011608D, 0.0114776584D, 0.0113219990D, 0.0109773358D, 0.0107353464D, 0.0105912842D, 0.0104092257D, 0.0101404298D, 0.0106571683D, 0.0103356530D, 0.0105651961D, 0.0106252261D, 0.0103672764D, 0.0100514629D, 0.0108297554D, 0.0105171040D, 0.0102857543D, 0.0099825267D  };

        [Test]
        public void ShouldBeEqualToExcel()
        {
            Math.Round(MathNet.Numerics.Statistics.Statistics.StandardDeviation(values), 14).Should().Be(0.00281131603207);
            Math.Round(MathNet.Numerics.Statistics.Statistics.PopulationStandardDeviation(values), 14).Should().Be(0.00280571021187);
        }
    }
}
